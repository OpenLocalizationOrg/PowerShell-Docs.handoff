{"content":"# DSC Script Resource\n\n \n> Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0\n\nThe **Script** resource in Windows PowerShell Desired State Configuration (DSC) provides a mechanism to run Windows PowerShell script blocks on target nodes.\n\n## Syntax\n\n```\nScript [string] #ResourceName\n{\n    GetScript = [string]\n    SetScript = [string]\n    TestScript = [string]\n    [ Credential = [PSCredential] ]\n    [ DependsOn = [string[]] ]\n}\n```\n\n## Properties\n\n|  Property  |  Description   | \n|---|---| \n| GetScript| Provides a block of Windows PowerShell script that runs when you invoke the [Get-DscConfiguration](https://technet.microsoft.com/en-us/library/dn407379.aspx) cmdlet. This block must return a hash table.| \n| SetScript| Provides a block of Windows PowerShell script. When you invoke the [Start-DscConfiguration](https://technet.microsoft.com/en-us/library/dn521623.aspx) cmdlet, the **TestScript** block runs first. If the **TestScript** block returns **$false**, the **SetScript** block will run. If the **TestScript** block returns **$true**, the **SetScript** block will not run.| \n| TestScript| Provides a block of Windows PowerShell script. When you invoke the [Start-DscConfiguration](https://technet.microsoft.com/en-us/library/dn521623.aspx) cmdlet, this block runs. If it returns **$false**, the SetScript block will run. If it returns **$true**, the SetScript block will not run. The **TestScript** block also runs when you invoke the [Test-DscConfiguration](https://technet.microsoft.com/en-us/library/dn407382.aspx) cmdlet. However, in this case, the **SetScript** block will not run, no matter what value the TestScript block returns. The **TestScript** block must return True if the actual configuration matches the current desired state configuration, and False if it does not match. (The current desired state configuration is the last configuration enacted on the node that is using DSC.)| \n| Credential| Indicates the credentials to use for running this script, if credentials are required.| \n| DependsOn| Indicates that the configuration of another resource must run before this resource is configured. For example, if the ID of the resource configuration script block that you want to run first is **ResourceName** and its type is **ResourceType**, the syntax for using this property is `DependsOn = \"[ResourceType]ResourceName\"`.\n\n## Example\n```powershell\nScript ScriptExample\n{\n    SetScript = { \n        $sw = New-Object System.IO.StreamWriter(\"C:\\TempFolder\\TestFile.txt\")\n        $sw.WriteLine(\"Some sample string\")\n        $sw.Close()\n    }\n    TestScript = { Test-Path \"C:\\TempFolder\\TestFile.txt\" }\n    GetScript = { <# This must return a hash table #> }          \n}\n```\n\n","nodes":[{"content":"DSC Script Resource","pos":[2,21]},{"content":"Applies To: Windows PowerShell 4.0, Windows PowerShell 5.0","pos":[27,85]},{"pos":[87,244],"content":"The <bpt id=\"p1\">**</bpt>Script<ept id=\"p1\">**</ept> resource in Windows PowerShell Desired State Configuration (DSC) provides a mechanism to run Windows PowerShell script blocks on target nodes.","source":"The **Script** resource in Windows PowerShell Desired State Configuration (DSC) provides a mechanism to run Windows PowerShell script blocks on target nodes."},{"content":"Syntax","pos":[249,255]},{"content":"Properties","pos":[446,456]},{"content":"Property","pos":[461,469]},{"content":"Description","pos":[474,485]},{"content":"GetScript","pos":[504,513]},{"content":"Provides a block of Windows PowerShell script that runs when you invoke the <bpt id=\"p1\">[</bpt>Get-DscConfiguration<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn407379.aspx)</ept> cmdlet.","pos":[515,680],"source":"Provides a block of Windows PowerShell script that runs when you invoke the [Get-DscConfiguration](https://technet.microsoft.com/en-us/library/dn407379.aspx) cmdlet."},{"content":"This block must return a hash table.","pos":[681,717]},{"content":"SetScript","pos":[722,731]},{"content":"Provides a block of Windows PowerShell script.","pos":[733,779]},{"content":"When you invoke the <bpt id=\"p1\">[</bpt>Start-DscConfiguration<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn521623.aspx)</ept> cmdlet, the <bpt id=\"p2\">**</bpt>TestScript<ept id=\"p2\">**</ept> block runs first.","pos":[780,928],"source":" When you invoke the [Start-DscConfiguration](https://technet.microsoft.com/en-us/library/dn521623.aspx) cmdlet, the **TestScript** block runs first."},{"content":"If the <bpt id=\"p1\">**</bpt>TestScript<ept id=\"p1\">**</ept> block returns <bpt id=\"p2\">**</bpt>$false<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>SetScript<ept id=\"p3\">**</ept> block will run.","pos":[929,1010],"source":" If the **TestScript** block returns **$false**, the **SetScript** block will run."},{"content":"If the <bpt id=\"p1\">**</bpt>TestScript<ept id=\"p1\">**</ept> block returns <bpt id=\"p2\">**</bpt>$true<ept id=\"p2\">**</ept>, the <bpt id=\"p3\">**</bpt>SetScript<ept id=\"p3\">**</ept> block will not run.","pos":[1011,1095],"source":" If the **TestScript** block returns **$true**, the **SetScript** block will not run."},{"content":"TestScript","pos":[1100,1110]},{"content":"Provides a block of Windows PowerShell script.","pos":[1112,1158]},{"content":"When you invoke the <bpt id=\"p1\">[</bpt>Start-DscConfiguration<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dn521623.aspx)</ept> cmdlet, this block runs.","pos":[1159,1287],"source":" When you invoke the [Start-DscConfiguration](https://technet.microsoft.com/en-us/library/dn521623.aspx) cmdlet, this block runs."},{"content":"If it returns <bpt id=\"p1\">**</bpt>$false<ept id=\"p1\">**</ept>, the SetScript block will run.","pos":[1288,1343],"source":" If it returns **$false**, the SetScript block will run."},{"content":"If it returns <bpt id=\"p1\">**</bpt>$true<ept id=\"p1\">**</ept>, the SetScript block will not run.","pos":[1344,1402],"source":" If it returns **$true**, the SetScript block will not run."},{"content":"The <bpt id=\"p1\">**</bpt>TestScript<ept id=\"p1\">**</ept> block also runs when you invoke the <bpt id=\"p2\">[</bpt>Test-DscConfiguration<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/dn407382.aspx)</ept> cmdlet.","pos":[1403,1548],"source":" The **TestScript** block also runs when you invoke the [Test-DscConfiguration](https://technet.microsoft.com/en-us/library/dn407382.aspx) cmdlet."},{"content":"However, in this case, the <bpt id=\"p1\">**</bpt>SetScript<ept id=\"p1\">**</ept> block will not run, no matter what value the TestScript block returns.","pos":[1549,1660],"source":" However, in this case, the **SetScript** block will not run, no matter what value the TestScript block returns."},{"content":"The <bpt id=\"p1\">**</bpt>TestScript<ept id=\"p1\">**</ept> block must return True if the actual configuration matches the current desired state configuration, and False if it does not match.","pos":[1661,1811],"source":" The **TestScript** block must return True if the actual configuration matches the current desired state configuration, and False if it does not match."},{"content":"(The current desired state configuration is the last configuration enacted on the node that is using DSC.)","pos":[1812,1918]},{"content":"Credential","pos":[1923,1933]},{"content":"Indicates the credentials to use for running this script, if credentials are required.","pos":[1935,2021]},{"content":"DependsOn","pos":[2026,2035]},{"content":"Indicates that the configuration of another resource must run before this resource is configured.","pos":[2037,2134]},{"content":"For example, if the ID of the resource configuration script block that you want to run first is <bpt id=\"p1\">**</bpt>ResourceName<ept id=\"p1\">**</ept> and its type is <bpt id=\"p2\">**</bpt>ResourceType<ept id=\"p2\">**</ept>, the syntax for using this property is <ph id=\"ph1\">`DependsOn = \"[ResourceType]ResourceName\"`</ph>.","pos":[2135,2363],"source":" For example, if the ID of the resource configuration script block that you want to run first is **ResourceName** and its type is **ResourceType**, the syntax for using this property is `DependsOn = \"[ResourceType]ResourceName\"`."},{"content":"Example","pos":[2368,2375]}]}